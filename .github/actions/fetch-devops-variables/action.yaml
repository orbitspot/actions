name: 'Devops Variables'
description: 'fetch devops variables'
inputs:
  devops_config_develop:
    description: 'devops config'
    required: true
  devops_config_homolog:
    description: 'devops config'
    required: true
  devops_config_master:
    description: 'devops config'
    required: true
  branch:
    description: 'branch'
    required: true
runs:
  using: composite
  steps:
  - name: Determine configuration variable
    shell: bash
    run: |
      if [[ "${{ inputs.branch }}" == "develop" ]]; then 
        echo 'CONFIG=${{ inputs.devops_config_develop }}' >> $GITHUB_ENV
      elif [[ "${{ inputs.branch }}" == "homolog" ]]; then
        echo "CONFIG=${{ inputs.devops_config_homolog }}" >> $GITHUB_ENV
      elif [[ "${{ inputs.branch }}" == "master" ]]; then
        echo "CONFIG=${{ inputs.devops_config_master }}" >> $GITHUB_ENV
      fi

  - name: Set config as output
    shell: bash
    id: set-output
    run: |
      keys=$(echo $CONFIG | jq -r 'keys_unsorted[]')
      for key in $keys; do
        value=$(echo $CONFIG | jq -r ".\"$key\"")
        echo "$key=$value" >> $GITHUB_OUTPUT
      done